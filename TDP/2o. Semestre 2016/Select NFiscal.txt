SELECT SUM(NFT_VALORTOTALNOTA) AS VALOR
FROM NFISCAL
INNER JOIN NFISCALTOTAIS ON (NF_EMPRESA=NFT_EMPRESA AND
                             NF_NUMERO=NFT_NUMERO AND NF_TIPO=NFT_TIPO)
WHERE NF_EMPRESA = :EMPRESA AND NF_TIPO IN ('CP', 'NF', 'S1', 'S2', 'S5') AND
      NF_EMISSAO BETWEEN :DATAINI AND :DATAFIM AND
     ((NF_OPERACAO = :OPERACAO) or (NF_OPERACAO IS NULL)) AND
     NF_STATUSNFE = :STATUS